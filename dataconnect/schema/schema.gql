# Data Connect Schema for WaterParty (Synced with models.go)

type User @table {
  id: String! @primaryKey
  username: String! @unique
  realName: String
  phoneNumber: String
  email: String
  profilePhotos: [String]
  age: Int
  dateOfBirth: Date
  heightCm: Int
  gender: String
  lookingFor: [String]
  drinkingPref: String
  smokingPref: String
  cannabisPref: String
  musicGenres: [String]
  topArtists: [String]
  jobTitle: String
  company: String
  school: String
  degree: String
  instagramHandle: String
  twitterHandle: String
  linkedinHandle: String
  xHandle: String
  tiktokHandle: String
  isVerified: Boolean
  trustScore: Float
  eloScore: Float
  partiesHosted: Int
  flakeCount: Int
  walletAddress: String
  locationLat: Float
  locationLon: Float
  lastActiveAt: Timestamp
  createdAt: Timestamp @default(expr: "request.time")
  bio: String
  interests: [String]
  vibeTags: [String]
}

type Party @table {
  id: String! @primaryKey
  hostId: String!
  host: User! @ref(fields: ["hostId"])
  title: String!
  description: String
  partyPhotos: [String]
  startTime: Timestamp!
  endTime: Timestamp!
  status: String # PartyStatus: OPEN, LOCKED, etc.
  isLocationRevealed: Boolean
  address: String
  city: String
  geoLat: Float
  geoLon: Float
  maxCapacity: Int
  currentGuestCount: Int
  # slotRequirements: Json # Not supported directly in all Data Connect versions, typically handled as String or separate table
  autoLockOnFull: Boolean
  vibeTags: [String]
  musicGenres: [String]
  mood: String
  rules: [String]
  chatRoomId: String
  createdAt: Timestamp @default(expr: "request.time")
  updatedAt: Timestamp
}

type ChatMessage @table {
  id: String! @primaryKey
  chatId: String!
  senderId: String!
  sender: User! @ref(fields: ["senderId"])
  type: String # MessageType: TEXT, IMAGE, etc.
  content: String!
  mediaUrl: String
  thumbnailURL: String
  replyToId: String
  createdAt: Timestamp @default(expr: "request.time")
}

type Crowdfunding @table {
  id: String! @primaryKey
  partyId: String!
  party: Party! @ref(fields: ["partyId"])
  targetAmount: Float!
  currentAmount: Float!
  currency: String
  isFunded: Boolean
}
